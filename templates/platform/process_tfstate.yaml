- debug:
    msg:
      - "{{lz_type}}"

- name: "Verify {{deployment}} {{lz_type}} is defined under tfstates:platform in {{config_folder}}/tfstates.yaml :"
  debug:
    msg: 
    - "{{config.tfstates[lz_type][deployment]}}"
    - "resources - {{resources}}"

- name: "{{deployment}} - tfstate_object sub_template_folder- {{env}}"
  debug:
    msg: 
    - 'sub_template_folder - {{tfstate_object.sub_template_folder | default()}}'
    - 'tfstate_object      - {{tfstate_object}}'
    verbosity: 2

- name: "{{deployment}} - process subscription resources"
  include_tasks: "process_subscription_resources.yaml"
  loop: "{{resources.subscriptions.keys()}}"
  loop_control:
    loop_var: subscription_key
  vars:
    level: "{{tfstate_object.level}}"
